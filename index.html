<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="A layout example that shows off a blog page with a list of posts.">

  <title>JS Practice &ndash; + Pure.css Layout Example</title>

  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
  <link rel="stylesheet" href="css/libs/c3.min.css">
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->

  <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
    <link rel="stylesheet" href="css/layouts/blog-old-ie.css">
  <![endif]-->

  <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="css/layouts/blog.css">
  <!--<![endif]-->

</head>
<body>

<div id="layout" class="pure-g">
  <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
      <h1 class="brand-title">Javascript Exercises</h1>
      <nav class="nav">
        <h2 class="brand-tagline">Lynda JS Code Clinic</h2>
        <ul class="nav-list">
          <li class="nav-item">
            <a class="pure-button" href="">Mean and Medium</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <div class="content pure-u-1 pure-u-md-3-4">
    <div>
      <!-- A wrapper for all the blog posts -->
      <div class="posts">
        <h1 class="content-subhead">Exercise</h1>

        <!-- A single blog post -->
        <section class="post">
          <header class="post-header">
            <h2 class="post-title">Mean And Medium</h2>

            <p class="post-meta">
              6.29.2015 -  <a class="post-category post-category-design" href="#">Lynda JS Code Clinic</a> <a class="post-category post-category-pure" href="#">AJAX</a> <a class="post-category post-category-js" href="#">JSON</a>
            </p>
          </header>

          <div class="post-description">
            <p>
              As part of that testing the US Navy compiles an exhaustive list of weather statistics such as wind speed, air temperature, and barometric pressure. You can browse this data by pointing your web browser at http://lpo.dt.navy.mil.  In this challenge, each of our authors will use their favorite language to calculate the mean and median of the wind speed, air temperature, and barometric pressure, recorded at the Deep Moor station for a given range of dates.</p>
          </div>
          <div class="post-content">
            <a class="pure-button pure-button-primary">My Solution</a>
          </div>
        </section>
      </div>



      <div class="footer">
        <div class="pure-menu pure-menu-horizontal">
          <ul>
            <li class="pure-menu-item"><a href="" class="pure-menu-link">About</a></li>
            <li class="pure-menu-item"><a href="" class="pure-menu-link">Twitter</a></li>
            <li class="pure-menu-item"><a href="" class="pure-menu-link">GitHub</a></li>
          </ul>
        </div>
      </div><!-- /.footer -->
    </div><!-- .box? -->
  </div><!-- /.content -->
</div><!-- /.layout -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="/js/libs/d3.min.js" charset="utf-8"></script>
<script src="/js/libs/c3.min.js"></script>
<script>
  $(function() {
    'use strict';

    function ajaxData() {
      $.ajax({
        url: 'http://foundationphp.com/phpclinic/podata.php?&raw&callback=?',
        jsonpCallback: 'jsonReturnData',
        dataType: 'jsonp',
        data: {
          startDate: '20150301',
          endDate: '20150302',
          format: 'json'
        },
        success: function(data) {
          // abstract into some function

          for (var date in data) {
            console.log(data[date]);
            for (var props in data[date]) {
              var values = data[date][props];
              var totalValues = values.length;
              var numValues;
              var indValues;
              var orderedValue1 = (totalValues/2) - 1;
              var orderedValue2 = (totalValues/2) + 1;
              var sortedValues = [];
              var meanTotal = 0; // reset mean + medium counter
              console.log(props + ': ' + totalValues);

              for (var i = 0; i < totalValues; i++) {
                indValues = values.slice(i, (i+1));
                numValues = parseFloat(indValues);
                sortedValues.push(numValues);
                meanTotal += numValues;
              } // get mean
              console.log('mean: ' + (meanTotal/totalValues));

              // sort the array in order of smallest to largest
              sortedValues.sort();

              if (totalValues % 2 === 0) {
                // get the mean of two middle numbers
                console.log('medium(even): ' + ((orderedValue1 + orderedValue2)/2));
                // return (orderedValue1 + orderedValue2)/2;
              } else {
                // we odd
                console.log('medium(odd): ' + sortedValues.slice(orderedValue1, orderedValue2));
                // return sortedValues.slice(orderedValue1, orderedValue2);
              } // get medium

            }// loop through each object in date s. t. p.

          } // loop through json to get dates requested

        }
      });
    } // ajaxData



    //Lynda Solutions to mean + medium
    function loadChart() {
      $.ajax({
        url: 'http://foundationphp.com/phpclinic/podata.php?&raw&callback=?',
        jsonpCallback: 'jsonReturnData',
        dataType: 'jsonp',
        data: {
          startDate: '20150301',
          endDate: '20150302',
          format: 'json'
        },
        success: function(response){
          console.log(response);
          console.log(processData(response));
        }
      });
    } // ajaxin' stuff

    function getMean(myArray) {
      var mean = myArray.reduce(function(a,b){
        return a + b;
      })/myArray.length;
      return mean.toFixed(2);
    } // getMean

    function getMedian(myArray) {
      var median;
      var sorted = myArray.sort(myArray);
      var middleIndex = Math.floor(sorted.length/2)
      if (sorted.length % 2 === 0) {
        var medianA = sorted[middleIndex];
        var medianB = sorted[middleIndex - 1];
        median = (medianA + medianB)/2;
      } else {
        median = sorted[middleIndex];
      }

      return median.toFixed(2);
    } // getMedian

    function processData(data) {
      var myData = [];

      var myDates = ['x'];
      var meanTemps = ['Mean Temperature'];
      var medTemps = ['Median Temperature'];
      var meanPress = ['Mean Pressure'];
      var medPress = ['Median Pressure'];
      var meanSpeeds = ['Mean Speed'];
      var medSpeeds = ['Median Speed'];

      for (var key in data) {
        if (data.hasOwnProperty(key)) {
          if ((data[key].t !== null) &&
          (data[key].p !== null) &&
          (data[key].s !== null)) {
            myDates.push(key);
            meanTemps.push(getMean(data[key].t));
            medTemps.push(getMedian(data[key].t));
            meanPress.push(getMean(data[key].p));
            medPress.push(getMedian(data[key].p));
            meanSpeeds.push(getMean(data[key].s));
            medSpeeds.push(getMedian(data[key].s));
          } // data is not null
        } // hasOwnProperty
      } // for key in data
      myData.push(myDates, meanTemps, medTemps, meanPress, medPress, meanSpeeds, medSpeeds);
      return myData;
    } // processData

    function generateChart(data) {
      var chart = c3.generate({

        data: {
          x: 'x',
          columns: data
        },
        axis: {
          x: {
            type: 'timeseries'
          }
        } // axis
      }); // chart
    } // generateChart

    // ajaxData();
    loadChart();
  }); //page loaded
</script>

</body>
</html>
